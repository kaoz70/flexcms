(function(){var b=/^(H[1-6]|HR|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|SCRIPT|NOSCRIPT|STYLE)$/i,d=/^(https?|ftp|rmtp|mms):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i,e=/<(script|noscript|style)[\u0000-\uFFFF]*?<\/(script|noscript|style)>/g;this.MooEditable=new Class({Implements:[Events,Options],options:{toolbar:!0,cleanup:!0,paragraphise:!0,xhtml:!0,semantics:!0,actions:"bold italic underline strikethrough | insertunorderedlist insertorderedlist indent outdent | undo redo | createlink unlink | urlimage | toggleview",
handleSubmit:!0,handleLabel:!0,disabled:!1,baseCSS:"html{ height: 100%; cursor: text; } body{ font-family: sans-serif; }",extraCSS:"",externalCSS:"",html:'<!DOCTYPE html><html><head><meta charset="UTF-8">{BASEHREF}<style>{BASECSS} {EXTRACSS}</style>{EXTERNALCSS}</head><body></body></html>',rootElement:"p",baseURL:"",dimensions:null},initialize:function(a,c){if("contentEditable"in document.body||"designMode"in document)this.setOptions(c),this.textarea=document.id(a),this.textarea.store("MooEditable",
this),this.actions=this.options.actions.clean().split(" "),this.keys={},this.dialogs={},this.protectedElements=[],this.actions.each(function(a){var c=MooEditable.Actions[a];if(c){if(c.options){var b=c.options.shortcut;b&&(this.keys[b]=a)}c.dialogs&&Object.each(c.dialogs,function(c,b){c=c.attempt(this);c.name=a+":"+b;"object"!=typeOf(this.dialogs[a])&&(this.dialogs[a]={});this.dialogs[a][b]=c},this);c.events&&Object.each(c.events,function(a,c){this.addEvent(c,a)},this)}}.bind(this)),this.render()},
toElement:function(){return this.textarea},render:function(){var a=this,c=this.options.dimensions||this.textarea.getSize();this.container=new Element("div",{id:this.textarea.id?this.textarea.id+"-mooeditable-container":null,"class":"mooeditable-container",styles:{width:c.x}});this.textarea.addClass("mooeditable-textarea").setStyle("height",c.y);this.iframe=new IFrame({"class":"mooeditable-iframe",frameBorder:0,src:'javascript:""',styles:{height:c.y}});this.toolbar=new MooEditable.UI.Toolbar({onItemAction:function(){var c=
Array.from(arguments);a.action(c[0].name,c)}});this.attach.delay(1,this);this.options.handleLabel&&this.textarea.id&&$$('label[for="'+this.textarea.id+'"]').addEvent("click",function(c){"iframe"==a.mode&&(c.preventDefault(),a.focus())});if(this.options.handleSubmit){this.form=this.textarea.getParent("form");if(!this.form)return;this.form.addEvent("submit",function(){"iframe"==a.mode&&a.saveContent()})}this.fireEvent("render",this)},attach:function(){var a=this;this.mode="iframe";this.editorDisabled=
!1;this.container.wraps(this.textarea);this.textarea.setStyle("display","none");this.iframe.setStyle("display","").inject(this.textarea,"before");Object.each(this.dialogs,function(c,b){Object.each(c,function(c){document.id(c).inject(a.iframe,"before");var d;c.addEvents({open:function(){d=a.selection.getRange();a.editorDisabled=!0;a.toolbar.disable(b);a.fireEvent("dialogOpen",this)},close:function(){a.toolbar.enable();a.editorDisabled=!1;a.focus();d&&a.selection.setRange(d);a.fireEvent("dialogClose",
this)}})})});this.win=this.iframe.contentWindow;this.doc=this.win.document;Browser.firefox&&(this.doc.designMode="On");var c=this.options.html.substitute({BASECSS:this.options.baseCSS,EXTRACSS:this.options.extraCSS,EXTERNALCSS:this.options.externalCSS?'<link rel="stylesheet" href="'+this.options.externalCSS+'">':"",BASEHREF:this.options.baseURL?'<base href="'+this.options.baseURL+'" />':""});this.doc.open();this.doc.write(c);this.doc.close();Browser.ie?this.doc.body.contentEditable=!0:this.doc.designMode=
"On";Object.append(this.win,new Window);Object.append(this.doc,new Document);if(Browser.Element){var c=this.win.Element.prototype,b;for(b in Element)b.test(/^[A-Z]|\$|prototype|mooEditable/)||(c[b]=Element.prototype[b])}else document.id(this.doc.body);this.setContent(this.textarea.get("value"));this.doc.addEvents({mouseup:this.editorMouseUp.bind(this),mousedown:this.editorMouseDown.bind(this),mouseover:this.editorMouseOver.bind(this),mouseout:this.editorMouseOut.bind(this),mouseenter:this.editorMouseEnter.bind(this),
mouseleave:this.editorMouseLeave.bind(this),contextmenu:this.editorContextMenu.bind(this),click:this.editorClick.bind(this),dblclick:this.editorDoubleClick.bind(this),keypress:this.editorKeyPress.bind(this),keyup:this.editorKeyUp.bind(this),keydown:this.editorKeyDown.bind(this),focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this)});this.win.addEvents({focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this)});["cut","copy","paste"].each(function(c){a.doc.body.addListener(c,a["editor"+
c.capitalize()].bind(a))});this.textarea.addEvent("keypress",this.textarea.retrieve("mooeditable:textareaKeyListener",this.keyListener.bind(this)));Browser.firefox2&&this.doc.addEvent("focus",function(){a.win.fireEvent("focus").focus()});this.doc.addEventListener&&this.doc.addEventListener("focus",function(){a.win.fireEvent("focus")},!0);if(!Browser.ie&&!Browser.opera){var d=function(){a.execute("styleWithCSS",false,false);a.doc.removeEvent("focus",d)};this.win.addEvent("focus",d)}this.options.toolbar&&
(document.id(this.toolbar).inject(this.container,"top"),this.toolbar.render(this.actions));this.options.disabled&&this.disable();this.selection=new MooEditable.Selection(this.win);this.oldContent=this.getContent();this.fireEvent("attach",this);return this},detach:function(){this.saveContent();this.textarea.setStyle("display","").removeClass("mooeditable-textarea").inject(this.container,"before");this.textarea.removeEvent("keypress",this.textarea.retrieve("mooeditable:textareaKeyListener"));this.container.dispose();
this.fireEvent("detach",this);return this},enable:function(){this.editorDisabled=!1;this.toolbar.enable();return this},disable:function(){this.editorDisabled=!0;this.toolbar.disable();return this},editorFocus:function(a){this.oldContent="";this.fireEvent("editorFocus",[a,this])},editorBlur:function(a){this.oldContent=this.saveContent().getContent();this.fireEvent("editorBlur",[a,this])},editorMouseUp:function(a){this.editorDisabled?a.stop():(this.options.toolbar&&this.checkStates(),this.fireEvent("editorMouseUp",
[a,this]))},editorMouseDown:function(a){this.editorDisabled?a.stop():this.fireEvent("editorMouseDown",[a,this])},editorMouseOver:function(a){this.editorDisabled?a.stop():this.fireEvent("editorMouseOver",[a,this])},editorMouseOut:function(a){this.editorDisabled?a.stop():this.fireEvent("editorMouseOut",[a,this])},editorMouseEnter:function(a){this.editorDisabled?a.stop():(this.oldContent&&this.getContent()!=this.oldContent&&(this.focus(),this.fireEvent("editorPaste",[a,this])),this.fireEvent("editorMouseEnter",
[a,this]))},editorMouseLeave:function(a){this.editorDisabled?a.stop():this.fireEvent("editorMouseLeave",[a,this])},editorContextMenu:function(a){this.editorDisabled?a.stop():this.fireEvent("editorContextMenu",[a,this])},editorClick:function(a){if(Browser.safari||Browser.chrome){var c=a.target;"img"==Element.get(c,"tag")&&(this.options.baseURL&&-1==c.getProperty("src").indexOf("http://")&&c.setProperty("src",this.options.baseURL+c.getProperty("src")),this.selection.selectNode(c),this.checkStates())}this.fireEvent("editorClick",
[a,this])},editorDoubleClick:function(a){this.fireEvent("editorDoubleClick",[a,this])},editorKeyPress:function(a){this.editorDisabled?a.stop():(this.keyListener(a),this.fireEvent("editorKeyPress",[a,this]))},editorKeyUp:function(a){if(this.editorDisabled)a.stop();else{var c=a.code;if(this.options.toolbar&&(/^enter|left|up|right|down|delete|backspace$/i.test(a.key)||33<=c&&36>=c||45==c||a.meta||a.control))Browser.ie6?(clearTimeout(this.checkStatesDelay),this.checkStatesDelay=this.checkStates.delay(500,
this)):this.checkStates();this.fireEvent("editorKeyUp",[a,this])}},editorKeyDown:function(a){if(this.editorDisabled)a.stop();else{if("enter"==a.key)if(this.options.paragraphise)if(a.shift&&(Browser.safari||Browser.chrome)){var c=this.selection,d=c.getRange(),e=this.doc.createElement("br");d.insertNode(e);d.setStartAfter(e);d.setEndAfter(e);c.setRange(d);if(c.getSelection().focusNode==e.previousSibling){var d=this.doc.createTextNode("\u00a0"),f=e.parentNode;(e=e.nextSibling)?f.insertBefore(d,e):f.appendChild(d);
c.selectNode(d);c.collapse(1)}this.win.scrollTo(0,Element.getOffsets(c.getRange().startContainer).y);a.preventDefault()}else{if(Browser.firefox||Browser.safari||Browser.chrome)c=this.selection.getNode(),Element.getParents(c).include(c).some(function(a){return a.nodeName.test(b)})||this.execute("insertparagraph")}else Browser.ie&&(d=this.selection.getRange(),c=this.selection.getNode(),d&&"li"!=c.get("tag")&&(this.selection.insertContent("<br>"),this.selection.collapse(!1)),a.preventDefault());Browser.opera&&
((c=a.control||a.meta)&&"x"==a.key?this.fireEvent("editorCut",[a,this]):c&&"c"==a.key?this.fireEvent("editorCopy",[a,this]):(c&&"v"==a.key||a.shift&&45==a.code)&&this.fireEvent("editorPaste",[a,this]));this.fireEvent("editorKeyDown",[a,this])}},editorCut:function(a){this.editorDisabled?a.stop():this.fireEvent("editorCut",[a,this])},editorCopy:function(a){this.editorDisabled?a.stop():this.fireEvent("editorCopy",[a,this])},editorPaste:function(a){this.editorDisabled?a.stop():this.fireEvent("editorPaste",
[a,this])},keyListener:function(a){if((Browser.Platform.mac?a.meta:a.control)&&this.keys[a.key])a.preventDefault(),this.toolbar.getItem(this.keys[a.key]).action(a)},focus:function(){("iframe"==this.mode?this.win:this.textarea).focus();this.fireEvent("focus",this);return this},action:function(a,c){var b=MooEditable.Actions[a];b.command&&"function"==typeOf(b.command)?b.command.apply(this,c):(this.focus(),this.execute(a,!1,c),"iframe"==this.mode&&this.checkStates())},execute:function(a,c,b){if(!this.busy)return this.busy=
!0,this.doc.execCommand(a,c,b),this.saveContent(),this.busy=!1},toggleView:function(){this.fireEvent("beforeToggleView",this);"textarea"==this.mode?(this.mode="iframe",this.iframe.setStyle("display",""),this.setContent(this.textarea.value),this.textarea.setStyle("display","none")):(this.saveContent(),this.mode="textarea",this.textarea.setStyle("display",""),this.iframe.setStyle("display","none"));this.fireEvent("toggleView",this);this.focus.delay(10,this);return this},getContent:function(){var a=
this.protectedElements;return this.cleanup(this.ensureRootElement(this.doc.body.get("html").replace(/<\!-- mooeditable:protect:([0-9]+) --\>/g,function(c,b){return a[b.toInt()]})))},setContent:function(a){var c=this.protectedElements,a=a.replace(e,function(a){c.push(a);return"<\!-- mooeditable:protect:"+(c.length-1)+" --\>"});this.doc.body.set("html",this.ensureRootElement(a));return this},saveContent:function(){"iframe"==this.mode&&this.textarea.set("value",this.getContent());return this},ensureRootElement:function(a){if(this.options.rootElement){for(var a=
new Element("div",{html:a.trim()}),c=-1,d=!1,e="",f=a.childNodes.length,g=0;g<f;g++){var h=a.childNodes[g],j=h.nodeName;!j.test(b)&&"#comment"!==j?"#text"===j?h.nodeValue.trim()&&(0>c&&(c=g),e+=h.nodeValue):(0>c&&(c=g),e+=(new Element("div")).adopt($(h).clone()).get("html")):d=!0;g==f-1&&(d=!0);if(0<=c&&d){d=new Element(this.options.rootElement,{html:e});a.replaceChild(d,a.childNodes[c]);for(c+=1;c<g;c++)a.removeChild(a.childNodes[c]),f--,g--,c--;c=-1;d=!1;e=""}}a=a.get("html").replace(/\n\n/g,"")}return a},
checkStates:function(){var a=this.selection.getNode();a&&"element"==typeOf(a)&&this.actions.each(function(c){var d=this.toolbar.getItem(c);if(d){d.deactivate();var e=MooEditable.Actions[c].states;if(e)if("function"==typeOf(e))e.attempt([document.id(a),d],this);else{try{if(this.doc.queryCommandState(c)){d.activate();return}}catch(f){}if(e.tags){c=a;do{var g=c.tagName.toLowerCase();if(e.tags.contains(g)){d.activate(g);break}}while(null!=(c=Element.getParent(c)))}if(e.css){c=a;do{var g=!1,h;for(h in e.css){var j=
e.css[h];c.style[h.camelCase()].contains(j)&&(d.activate(j),g=!0)}if(g||c.tagName.test(b))break}while(null!=(c=Element.getParent(c)))}}}}.bind(this))},cleanup:function(a){if(!this.options.cleanup)return a.trim();do{var c=a;this.options.baseURL&&(a=a.replace('="'+this.options.baseURL,'="'));a=a.replace(/<br class\="webkit-block-placeholder">/gi,"<br />");a=a.replace(/<span class="Apple-style-span">(.*)<\/span>/gi,"$1");a=a.replace(/ class="Apple-style-span"/gi,"");a=a.replace(/<span style="">/gi,"");
a=a.replace(/<p>\s*<br ?\/?>\s*<\/p>/gi,"<p>\u00a0</p>");a=a.replace(/<p>(&nbsp;|\s)*<\/p>/gi,"<p>\u00a0</p>");this.options.semantics||(a=a.replace(/\s*<br ?\/?>\s*<\/p>/gi,"</p>"));this.options.xhtml&&(a=a.replace(/<br>/gi,"<br />"));if(this.options.semantics){Browser.ie&&(a=a.replace(/<li>\s*<div>(.+?)<\/div><\/li>/g,"<li>$1</li>"));if(Browser.safari||Browser.chrome)a=a.replace(/^([\w\s]+.*?)<div>/i,"<p>$1</p><div>"),a=a.replace(/<div>(.+?)<\/div>/ig,"<p>$1</p>");Browser.ie||(a=a.replace(/<p>[\s\n]*(<(?:ul|ol)>.*?<\/(?:ul|ol)>)(.*?)<\/p>/ig,
"$1<p>$2</p>"),a=a.replace(/<\/(ol|ul)>\s*(?!<(?:p|ol|ul|img).*?>)((?:<[^>]*>)?\w.*)$/g,"</$1><p>$2</p>"));a=a.replace(/<br[^>]*><\/p>/g,"</p>");a=a.replace(/<p>\s*(<img[^>]+>)\s*<\/p>/ig,"$1\n");a=a.replace(/<p([^>]*)>(.*?)<\/p>(?!\n)/g,"<p$1>$2</p>\n");a=a.replace(/<\/(ul|ol|p)>(?!\n)/g,"</$1>\n");a=a.replace(/><li>/g,">\n\t<li>");a=a.replace(/([^\n])<\/(ol|ul)>/g,"$1\n</$2>");a=a.replace(/([^\n])<img/ig,"$1\n<img");a=a.replace(/^\s*$/g,"")}a=a.replace(/<br ?\/?>$/gi,"");a=a.replace(/^<br ?\/?>/gi,
"");this.options.paragraphise&&(a=a.replace(/(h[1-6]|p|div|address|pre|li|ol|ul|blockquote|center|dl|dt|dd)><br ?\/?>/gi,"$1>"));a=a.replace(/<br ?\/?>\s*<\/(h1|h2|h3|h4|h5|h6|li|p)/gi,"</$1");a=a.replace(/<span style="font-weight: bold;">(.*)<\/span>/gi,"<strong>$1</strong>");a=a.replace(/<span style="font-style: italic;">(.*)<\/span>/gi,"<em>$1</em>");a=a.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>");a=a.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>");a=a.replace(/<u\b[^>]*>(.*?)<\/u[^>]*>/gi,
'<span style="text-decoration: underline;">$1</span>');a=a.replace(/<strong><span style="font-weight: normal;">(.*)<\/span><\/strong>/gi,"$1");a=a.replace(/<em><span style="font-weight: normal;">(.*)<\/span><\/em>/gi,"$1");a=a.replace(/<span style="text-decoration: underline;"><span style="font-weight: normal;">(.*)<\/span><\/span>/gi,"$1");a=a.replace(/<strong style="font-weight: normal;">(.*)<\/strong>/gi,"$1");a=a.replace(/<em style="font-weight: normal;">(.*)<\/em>/gi,"$1");a=a.replace(/<[^> ]*/g,
function(a){return a.toLowerCase()});a=a.replace(/<[^>]*>/g,function(a){return a=a.replace(/ [^=]+=/g,function(a){return a.toLowerCase()})});a=a.replace(/<[^!][^>]*>/g,function(a){return a=a.replace(/( [^=]+=)([^"][^ >]*)/g,'$1"$2"')});this.options.xhtml&&(a=a.replace(/<img([^>]+)(\s*[^\/])>(<\/img>)*/gi,"<img$1$2 />"));a=a.replace(/<p>(?:\s*)<p>/g,"<p>");a=a.replace(/<\/p>\s*<\/p>/g,"</p>");a=a.replace(/<pre[^>]*>.*?<\/pre>/gi,function(a){return a.replace(/<br ?\/?>/gi,"\n")});a=a.trim()}while(a!=
c);return a}});MooEditable.Selection=new Class({initialize:function(a){this.win=a},getSelection:function(){this.win.focus();return this.win.getSelection?this.win.getSelection():this.win.document.selection},getRange:function(){var a=this.getSelection();if(!a)return null;try{return 0<a.rangeCount?a.getRangeAt(0):a.createRange?a.createRange():null}catch(c){return this.doc.body.createTextRange()}},setRange:function(a){if(a.select)Function.attempt(function(){a.select()});else{var c=this.getSelection();
c.addRange&&(c.removeAllRanges(),c.addRange(a))}},selectNode:function(a,c){var b=this.getRange(),d=this.getSelection();b.moveToElementText?Function.attempt(function(){b.moveToElementText(a);b.select()}):d.addRange?(c?b.selectNodeContents(a):b.selectNode(a),d.removeAllRanges(),d.addRange(b)):d.setBaseAndExtent(a,0,a,1);return a},isCollapsed:function(){var a=this.getRange();return a.item?!1:0==a.boundingWidth||this.getSelection().isCollapsed},collapse:function(a){var c=this.getRange(),b=this.getSelection();
c.select?(c.collapse(a),c.select()):a?b.collapseToStart():b.collapseToEnd()},getContent:function(){var a=this.getRange(),c=new Element("body");if(this.isCollapsed())return"";a.cloneContents?c.appendChild(a.cloneContents()):void 0!=a.item||void 0!=a.htmlText?c.set("html",a.item?a.item(0).outerHTML:a.htmlText):c.set("html",a.toString());return c.get("html")},getText:function(){var a=this.getRange(),c=this.getSelection();return this.isCollapsed()?"":a.text||(c.toString?c.toString():"")},getNode:function(){var a=
this.getRange();if(!Browser.ie||9<=Browser.version){var c=null;if(a){c=a.commonAncestorContainer;for(a.collapsed||a.startContainer==a.endContainer&&2>a.startOffset-a.endOffset&&a.startContainer.hasChildNodes()&&(c=a.startContainer.childNodes[a.startOffset]);"element"!=typeOf(c);)c=c.parentNode}return document.id(c)}return document.id(a.item?a.item(0):a.parentElement())},insertContent:function(a){if(Browser.ie){var c=this.getRange();if(c.pasteHTML)c.pasteHTML(a),c.collapse(!1),c.select();else if(c.insertNode)if(c.deleteContents(),
c.createContextualFragment)c.insertNode(c.createContextualFragment(a));else{var b=this.win.document,d=b.createDocumentFragment(),b=b.createElement("div");d.appendChild(b);b.outerHTML=a;c.insertNode(d)}}else this.win.document.execCommand("insertHTML",!1,a)}});var f={};MooEditable.Locale={define:function(a,c){if("null"!=typeOf(window.Locale))return Locale.define("en-US","MooEditable",a,c);"object"==typeOf(a)?Object.merge(f,a):f[a]=c},get:function(a){return"null"!=typeOf(window.Locale)?Locale.get("MooEditable."+
a):a?f[a]:""}};MooEditable.Locale.define({ok:"OK",cancel:"Cancel",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",unorderedList:"Unordered List",orderedList:"Ordered List",indent:"Indent",outdent:"Outdent",undo:"Undo",redo:"Redo",removeHyperlink:"Remove Hyperlink",addHyperlink:"Add Hyperlink",selectTextHyperlink:"Please select the text you wish to hyperlink.",enterURL:"Enter URL",enterImageURL:"Enter image URL",addImage:"Add Image",toggleView:"Toggle View"});MooEditable.UI=
{};MooEditable.UI.Toolbar=new Class({Implements:[Events,Options],options:{"class":""},initialize:function(a){this.setOptions(a);this.el=new Element("div",{"class":"mooeditable-ui-toolbar "+this.options["class"]});this.items={};this.content=null},toElement:function(){return this.el},render:function(a){this.content?this.el.adopt(this.content):this.content=a.map(function(a){return"|"==a?this.addSeparator():"/"==a?this.addLineSeparator():this.addItem(a)}.bind(this));return this},addItem:function(a){var c=
MooEditable.Actions[a];if(c){var b=c.options||{},c=new (MooEditable.UI[(c.type||"button").camelCase().capitalize()])(Object.append(b,{name:a,"class":a+"-item toolbar-item",title:c.title,onAction:this.itemAction.bind(this)}));this.items[a]=c;document.id(c).inject(this.el);return c}},getItem:function(a){return this.items[a]},addSeparator:function(){return(new Element("span.toolbar-separator")).inject(this.el)},addLineSeparator:function(){return(new Element("div.toolbar-line-separator")).inject(this.el)},
itemAction:function(){this.fireEvent("itemAction",arguments)},disable:function(a){Object.each(this.items,function(c){c.name==a?c.activate():c.deactivate().disable()});return this},enable:function(){Object.each(this.items,function(a){a.enable()});return this},show:function(){this.el.setStyle("display","");return this},hide:function(){this.el.setStyle("display","none");return this}});MooEditable.UI.Button=new Class({Implements:[Events,Options],options:{title:"",name:"",text:"Button","class":"",shortcut:"",
mode:"icon"},initialize:function(a){this.setOptions(a);this.name=this.options.name;this.render()},toElement:function(){return this.el},render:function(){var a=Browser.Platform.mac?"Cmd":"Ctrl",a=this.options.shortcut?" ( "+a+"+"+this.options.shortcut.toUpperCase()+" )":"",c=this.options.title||name;this.el=new Element("button",{"class":"mooeditable-ui-button "+this.options["class"],title:c+a,html:'<span class="button-icon"></span><span class="button-text">'+c+"</span>",events:{click:this.click.bind(this),
mousedown:function(a){a.preventDefault()}}});"icon"!=this.options.mode&&this.el.addClass("mooeditable-ui-button-"+this.options.mode);this.disabled=this.active=!1;Browser.ie&&this.el.addEvents({mouseenter:function(){this.addClass("hover")},mouseleave:function(){this.removeClass("hover")}});return this},click:function(a){a.preventDefault();this.disabled||this.action(a)},action:function(){this.fireEvent("action",[this].concat(Array.from(arguments)))},enable:function(){this.active&&this.el.removeClass("onActive");
if(this.disabled)return this.disabled=!1,this.el.removeClass("disabled").set({disabled:!1,opacity:1}),this},disable:function(){if(!this.disabled)return this.disabled=!0,this.el.addClass("disabled").set({disabled:!0,opacity:0.4}),this},activate:function(){if(!this.disabled)return this.active=!0,this.el.addClass("onActive"),this},deactivate:function(){this.active=!1;this.el.removeClass("onActive");return this}});MooEditable.UI.Dialog=new Class({Implements:[Events,Options],options:{"class":"",contentClass:""},
initialize:function(a,c){this.setOptions(c);this.html=a;this.el=new Element("div",{"class":"mooeditable-ui-dialog "+this.options["class"],html:'<div class="dialog-content '+this.options.contentClass+'">'+a+"</div>",styles:{display:"none"},events:{click:this.click.bind(this)}})},toElement:function(){return this.el},click:function(){this.fireEvent("click",arguments);return this},open:function(){this.el.setStyle("display","");this.fireEvent("open",this);return this},close:function(){this.el.setStyle("display",
"none");this.fireEvent("close",this);return this}});MooEditable.UI.AlertDialog=function(a){if(a)return a=a+' <button class="dialog-ok-button">'+MooEditable.Locale.get("ok")+"</button>",new MooEditable.UI.Dialog(a,{"class":"mooeditable-alert-dialog",onOpen:function(){var a=this.el.getElement(".dialog-ok-button");(function(){a.focus()}).delay(10)},onClick:function(a){a.preventDefault();"button"==a.target.tagName.toLowerCase()&&document.id(a.target).hasClass("dialog-ok-button")&&this.close()}})};MooEditable.UI.PromptDialog=
function(a,c,b){if(a)return a='<label class="dialog-label">'+a+' <input type="text" class="text dialog-input" value="'+c+'"></label> <button class="dialog-button dialog-ok-button">'+MooEditable.Locale.get("ok")+'</button><button class="dialog-button dialog-cancel-button">'+MooEditable.Locale.get("cancel")+"</button>",new MooEditable.UI.Dialog(a,{"class":"mooeditable-prompt-dialog",onOpen:function(){var a=this.el.getElement(".dialog-input");(function(){a.focus();a.select()}).delay(10)},onClick:function(a){a.preventDefault();
if("button"==a.target.tagName.toLowerCase()){var d=document.id(a.target),a=this.el.getElement(".dialog-input");d.hasClass("dialog-cancel-button")?(a.set("value",c),this.close()):d.hasClass("dialog-ok-button")&&(d=a.get("value"),a.set("value",c),this.close(),b&&b.attempt(d,this))}}})};MooEditable.Actions={bold:{title:MooEditable.Locale.get("bold"),options:{shortcut:"b"},states:{tags:["b","strong"],css:{"font-weight":"bold"}},events:{beforeToggleView:function(){if(Browser.firefox){var a=this.textarea.get("value"),
c=a.replace(/<strong([^>]*)>/gi,"<b$1>").replace(/<\/strong>/gi,"</b>");a!=c&&this.textarea.set("value",c)}},attach:function(){if(Browser.firefox){var a=this.textarea.get("value"),c=a.replace(/<strong([^>]*)>/gi,"<b$1>").replace(/<\/strong>/gi,"</b>");a!=c&&(this.textarea.set("value",c),this.setContent(c))}}}},italic:{title:MooEditable.Locale.get("italic"),options:{shortcut:"i"},states:{tags:["i","em"],css:{"font-style":"italic"}},events:{beforeToggleView:function(){if(Browser.firefox){var a=this.textarea.get("value"),
c=a.replace(/<embed([^>]*)>/gi,"<tmpembed$1>").replace(/<em([^>]*)>/gi,"<i$1>").replace(/<tmpembed([^>]*)>/gi,"<embed$1>").replace(/<\/em>/gi,"</i>");a!=c&&this.textarea.set("value",c)}},attach:function(){if(Browser.firefox){var a=this.textarea.get("value"),c=a.replace(/<embed([^>]*)>/gi,"<tmpembed$1>").replace(/<em([^>]*)>/gi,"<i$1>").replace(/<tmpembed([^>]*)>/gi,"<embed$1>").replace(/<\/em>/gi,"</i>");a!=c&&(this.textarea.set("value",c),this.setContent(c))}}}},underline:{title:MooEditable.Locale.get("underline"),
options:{shortcut:"u"},states:{tags:["u"],css:{"text-decoration":"underline"}},events:{beforeToggleView:function(){if(Browser.firefox||Browser.ie){var a=this.textarea.get("value"),c=a.replace(/<span style="text-decoration: underline;"([^>]*)>/gi,"<u$1>").replace(/<\/span>/gi,"</u>");a!=c&&this.textarea.set("value",c)}},attach:function(){if(Browser.firefox||Browser.ie){var a=this.textarea.get("value"),c=a.replace(/<span style="text-decoration: underline;"([^>]*)>/gi,"<u$1>").replace(/<\/span>/gi,"</u>");
a!=c&&(this.textarea.set("value",c),this.setContent(c))}}}},strikethrough:{title:MooEditable.Locale.get("strikethrough"),options:{shortcut:"s"},states:{tags:["s","strike"],css:{"text-decoration":"line-through"}}},insertunorderedlist:{title:MooEditable.Locale.get("unorderedList"),states:{tags:["ul"]}},insertorderedlist:{title:MooEditable.Locale.get("orderedList"),states:{tags:["ol"]}},indent:{title:MooEditable.Locale.get("indent"),states:{tags:["blockquote"]}},outdent:{title:MooEditable.Locale.get("outdent")},
undo:{title:MooEditable.Locale.get("undo"),options:{shortcut:"z"}},redo:{title:MooEditable.Locale.get("redo"),options:{shortcut:"y"}},unlink:{title:MooEditable.Locale.get("removeHyperlink")},createlink:{title:MooEditable.Locale.get("addHyperlink"),options:{shortcut:"l"},states:{tags:["a"]},dialogs:{alert:MooEditable.UI.AlertDialog.pass(MooEditable.Locale.get("selectTextHyperlink")),prompt:function(a){return MooEditable.UI.PromptDialog(MooEditable.Locale.get("enterURL"),"http://",function(c){a.execute("createlink",
!1,c.trim())})}},command:function(){var a=this.selection,c=this.dialogs.createlink;if(a.isCollapsed()){var b=a.getNode();"a"==b.get("tag")&&b.get("href")?(a.selectNode(b),c=c.prompt,c.el.getElement(".dialog-input").set("value",b.get("href")),c.open()):c.alert.open()}else b=a.getText(),c=c.prompt,d.test(b)&&c.el.getElement(".dialog-input").set("value",b),c.open()}},urlimage:{title:MooEditable.Locale.get("addImage"),options:{shortcut:"m"},dialogs:{prompt:function(a){return MooEditable.UI.PromptDialog(MooEditable.Locale.get("enterImageURL"),
"http://",function(b){a.execute("insertimage",!1,b.trim())})}},command:function(){this.dialogs.urlimage.prompt.open()}},toggleview:{title:MooEditable.Locale.get("toggleView"),command:function(){"textarea"==this.mode?this.toolbar.enable():this.toolbar.disable("toggleview");this.toggleView()}}};MooEditable.Actions.Settings={};Element.Properties.mooeditable={get:function(){return this.retrieve("MooEditable")}};Element.implement({mooEditable:function(a){var b=this.get("mooeditable");b||(b=new MooEditable(this,
a));return b}})})();MooEditable.UI.MenuList=new Class({Implements:[Events,Options],options:{title:"",name:"","class":"",list:[]},initialize:function(b){this.setOptions(b);this.name=this.options.name;this.render()},toElement:function(){return this.el},render:function(){var b="";this.options.list.each(function(d){b+='<option value="{value}" style="{style}">{text}</option>'.substitute(d)});this.el=new Element("select",{"class":this.options["class"],title:this.options.title,html:b,styles:{height:"21px"},events:{change:this.change.bind(this)}});
this.disabled=!1;Browser.ie&&this.el.addEvents({mouseenter:function(){this.addClass("hover")},mouseleave:function(){this.removeClass("hover")}});return this},change:function(b){b.preventDefault();this.disabled||this.action(b.target.value)},action:function(){this.fireEvent("action",[this].concat(Array.from(arguments)))},enable:function(){if(this.disabled)return this.disabled=!1,this.el.set("disabled",!1).removeClass("disabled").set({disabled:!1,opacity:1}),this},disable:function(){if(!this.disabled)return this.disabled=
!0,this.el.set("disabled",!0).addClass("disabled").set({disabled:!0,opacity:0.4}),this},activate:function(b){if(!this.disabled){var d=0;b&&this.options.list.each(function(e,f){e.value==b&&(d=f)});this.el.selectedIndex=d;return this}},deactivate:function(){this.el.selectedIndex=0;this.el.removeClass("onActive");return this}});MooEditable.UI.ButtonOverlay=new Class({Extends:MooEditable.UI.Button,options:{overlayHTML:"",overlayClass:"",overlaySize:{x:150,y:"auto"},overlayContentClass:""},initialize:function(b){this.parent(b);this.render();this.el.addClass("mooeditable-ui-buttonOverlay");this.renderOverlay(this.options.overlayHTML)},renderOverlay:function(b){var d=this;this.overlay=(new Element("div",{"class":"mooeditable-ui-button-overlay "+d.name+"-overlay "+d.options.overlayClass,html:'<div class="overlay-content '+d.options.overlayContentClass+
'">'+b+"</div>",tabindex:0,styles:{left:"-999em",position:"absolute",width:d.options.overlaySize.x,height:d.options.overlaySize.y},events:{mousedown:d.clickOverlay.bind(d),focus:d.openOverlay.bind(d),blur:d.closeOverlay.bind(d)}})).inject(document.body).store("MooEditable.UI.ButtonOverlay",this);this.overlayVisible=!1;window.addEvent("resize",function(){d.overlayVisible&&d.positionOverlay()})},openOverlay:function(){if(!this.overlayVisible)return this.overlayVisible=!0,this.activate(),this.fireEvent("openOverlay",
this),this},closeOverlay:function(){if(this.overlayVisible)return this.overlay.setStyle("left","-999em"),this.overlayVisible=!1,this.deactivate(),this.fireEvent("closeOverlay",this),this},clickOverlay:function(b){b.target==this.overlay||b.target.parentNode==this.overlay||(this.overlay.blur(),b.preventDefault(),this.action(b))},click:function(b){b.preventDefault();this.disabled||(this.overlayVisible?this.overlay.blur():(this.positionOverlay(),this.overlay.focus()))},positionOverlay:function(){var b=
this.el.getCoordinates();this.overlay.setStyles({top:b.bottom,left:b.left});return this}});MooEditable.Locale.define({blockFormatting:"Block Formatting",paragraph:"Paragraph",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",alignLeft:"Align Left",alignRight:"Align Right",alignCenter:"Align Center",alignJustify:"Align Justify",removeFormatting:"Remove Formatting",insertHorizontalRule:"Insert Horizontal Rule"});
Object.append(MooEditable.Actions,{formatBlock:{title:MooEditable.Locale.get("blockFormatting"),type:"menu-list",options:{list:[{text:MooEditable.Locale.get("paragraph"),value:"p"},{text:MooEditable.Locale.get("heading1"),value:"h1",style:"font-size:24px; font-weight:bold;"},{text:MooEditable.Locale.get("heading2"),value:"h2",style:"font-size:18px; font-weight:bold;"},{text:MooEditable.Locale.get("heading3"),value:"h3",style:"font-size:14px; font-weight:bold;"}]},states:{tags:["p","h1","h2","h3"]},
command:function(b,d){var e="<"+d+">";this.focus();this.execute("formatBlock",!1,e)}},justifyleft:{title:MooEditable.Locale.get("alignLeft"),states:{css:{"text-align":"left"}}},justifyright:{title:MooEditable.Locale.get("alignRight"),states:{css:{"text-align":"right"}}},justifycenter:{title:MooEditable.Locale.get("alignCenter"),states:{tags:["center"],css:{"text-align":"center"}}},justifyfull:{title:MooEditable.Locale.get("alignJustify"),states:{css:{"text-align":"justify"}}},removeformat:{title:MooEditable.Locale.get("removeFormatting")},
insertHorizontalRule:{title:MooEditable.Locale.get("insertHorizontalRule"),states:{tags:["hr"]},command:function(){this.selection.insertContent("<hr>")}}});MooEditable.Group=new Class({Implements:[Options],options:{actions:"bold italic underline strikethrough | insertunorderedlist insertorderedlist indent outdent | undo redo | createlink unlink | urlimage | toggleview"},initialize:function(b,d){this.setOptions(d);this.actions=this.options.actions.clean().split(" ");var e=this;this.toolbar=(new MooEditable.UI.Toolbar({onItemAction:function(){var b=Array.from(arguments),a=b[0];e.activeEditor&&(e.activeEditor.focus(),e.activeEditor.action(a.name,b),"iframe"==
e.activeEditor.mode&&e.activeEditor.checkStates())}})).render(this.actions);document.id(b).adopt(this.toolbar)},add:function(b,d){return this.activeEditor=new MooEditable.Group.Item(b,this,Object.merge({toolbar:!1},this.options,d))}});
MooEditable.Group.Item=new Class({Extends:MooEditable,initialize:function(b,d,e){var f=this;this.group=d;this.parent(b,e);this.addEvent("attach",function(){var a=function(){this==f.win&&(f.group.activeEditor=f)};f.textarea.addEvent("focus",a);f.win.addEvent("focus",a)})}});MooEditable.Actions.Settings.forecolor={colors:["000000,993300,333300,003300,003366,000077,333399,333333".split(","),"770000,ff6600,777700,007700,007777,0000ff,666699,777777".split(","),"ff0000,ff9900,99cc00,339966,33cccc,3366f0,770077,999999".split(","),"ff00ff,ffcc00,ffff00,00ff00,00ffff,00ccff,993366,cccccc".split(","),"ff99cc,ffcc99,ffff99,ccffcc,ccffff,99ccff,cc9977,ffffff".split(",")]};MooEditable.Locale.define("changeColor","Change Color");
MooEditable.Actions.forecolor={type:"button-overlay",title:MooEditable.Locale.get("changeColor"),options:{overlaySize:{x:"auto"},overlayHTML:function(){var b="";MooEditable.Actions.Settings.forecolor.colors.each(function(d){d.each(function(d){b+='<a href="#" class="forecolor-colorpicker-color" style="background-color: #'+d+'" title="#'+d.toUpperCase()+'"></a>'});b+='<span class="forecolor-colorpicker-br"></span>'});return b}()},command:function(b,d){var e=d.target;"a"==e.tagName.toLowerCase()&&(this.execute("forecolor",
!1,$(e).getStyle("background-color")),this.focus())}};MooEditable.Actions.Settings.smiley={imagesPath:"../../Assets/MooEditable/Smiley/",smileys:"angryface,blush,gasp,grin,halo,lipsaresealed,smile,undecided,wink".split(","),fileExt:".png"};MooEditable.Locale.define("insertSmiley","Insert Smiley");
MooEditable.Actions.smiley={type:"button-overlay",title:MooEditable.Locale.get("insertSmiley"),options:{overlaySize:{x:"auto"},overlayHTML:function(){var b=MooEditable.Actions.Settings.smiley,d="";b.smileys.each(function(e){d+='<img src="'+b.imagesPath+e+b.fileExt+'" alt="" class="smiley-image">'});return d}()},command:function(b,d){var e=d.target;"img"==e.tagName.toLowerCase()&&(e='<img style="border:0;" class="smiley" src="'+$(e).get("src")+'" alt="">',this.focus(),this.selection.insertContent(e))},
events:{attach:function(b){Browser.ie&&b.doc.addListener("controlselect",function(b){var e=b.target||b.srcElement;"img"==e.tagName.toLowerCase()&&document.id(e).hasClass("smiley")&&(b.preventDefault?b.preventDefault():b.returnValue=!1)})},editorMouseDown:function(b,d){var e=b.target,f="img"==e.tagName.toLowerCase()&&$(e).hasClass("smiley");Function.attempt(function(){d.doc.execCommand("enableObjectResizing",!1,!f)})}}};MooEditable.Locale.define({tableColumns:"columns",tableRows:"rows",tableWidth:"width",tableClass:"class",tableType:"type",tableHeader:"Header",tableCell:"Cell",tableAlign:"align",tableAlignNone:"none",tableAlignCenter:"center",tableAlignRight:"right",tableValign:"vertical align",tableValignNone:"none",tableValignTop:"top",tableValignMiddle:"middle",tableValignBottom:"bottom",addTable:"Add Table",editTable:"Edit Table",addTableRow:"Add Table Row",editTableRow:"Edit Table Row",mergeTableRow:"Merge Table Row",
splitTableRow:"Split Table Row",deleteTableRow:"Delete Table Row",addTableCol:"Add Table Column",editTableCol:"Edit Table Column",mergeTableCell:"Merge Table Cell",splitTableCell:"Split Table Cell",deleteTableCol:"Delete Table Column"});
MooEditable.UI.TableDialog=function(b,d){var e={tableadd:MooEditable.Locale.get("tableColumns")+' <input type="text" class="table-c" value="" size="4"> '+MooEditable.Locale.get("tableRows")+' <input type="text" class="table-r" value="" size="4"> ',tableedit:MooEditable.Locale.get("tableWidth")+' <input type="text" class="table-w" value="" size="4"> '+MooEditable.Locale.get("tableClass")+' <input type="text" class="table-c" value="" size="15"> ',tablerowedit:MooEditable.Locale.get("tableClass")+' <input type="text" class="table-c" value="" size="15"> '+
MooEditable.Locale.get("tableType")+' <select class="table-c-type"><option value="th">'+MooEditable.Locale.get("tableHeader")+'</option><option value="td">'+MooEditable.Locale.get("tableCell")+"</option></select> ",tablecoledit:MooEditable.Locale.get("tableWidth")+' <input type="text" class="table-w" value="" size="4"> '+MooEditable.Locale.get("tableClass")+' <input type="text" class="table-c" value="" size="15"> '+MooEditable.Locale.get("tableAlign")+' <select class="table-a"><option>'+MooEditable.Locale.get("tableAlignNone")+
"</option><option>"+MooEditable.Locale.get("tableAlignLeft")+"</option><option>"+MooEditable.Locale.get("tableAlignCenter")+"</option><option>"+MooEditable.Locale.get("tableAlignRight")+"</option></select> "+MooEditable.Locale.get("tableValign")+' <select class="table-va"><option>'+MooEditable.Locale.get("tableValignNone")+"</option><option>"+MooEditable.Locale.get("tableValignTop")+"</option><option>"+MooEditable.Locale.get("tableValignMiddle")+"</option><option>"+MooEditable.Locale.get("tableValignBottom")+
"</option></select> "};e[d]+='<button class="dialog-button dialog-ok-button">'+MooEditable.Locale.get("ok")+'</button><button class="dialog-button dialog-cancel-button">'+MooEditable.Locale.get("cancel")+"</button>";var f={tableadd:{click:function(){var a=this.el.getElement(".table-c").value.toInt(),c=this.el.getElement(".table-r").value.toInt();if(0<c&&0<a){var d,e,f=[];d=new Element("tdiv");e=(new Element("table")).set("border",0).set("width","100%").inject(d);e=(new Element("tbody")).inject(e);
for(var g=0;g<c;g++){f[g]=(new Element("tr")).inject(e,"bottom");for(var h=0;h<a;h++)(new Element("td")).set("html","&nbsp;").inject(f[g],"bottom")}b.selection.insertContent(d.get("html"))}}},tableedit:{load:function(){var a=b.selection.getNode().getParent("table");this.el.getElement(".table-w").set("value",a.get("width"));this.el.getElement(".table-c").set("value",a.className)},click:function(){var a=b.selection.getNode().getParent("table");a.set("width",this.el.getElement(".table-w").value);a.className=
this.el.getElement(".table-c").value}},tablerowedit:{load:function(){var a=b.selection.getNode().getParent("tr");this.el.getElement(".table-c").set("value",a.className);this.el.getElement(".table-c-type").set("value",b.selection.getNode().get("tag"))},click:function(){var a=b.selection.getNode().getParent("tr");a.className=this.el.getElement(".table-c").value;a.getElements("td, th").each(function(a){if(this.el.getElement(".table-c-type")!=a.get("tag")){var d=b.doc.createElement(this.el.getElement(".table-c-type").get("value"));
$(d).set("html",a.get("html")).replaces(a)}},this)}},tablecoledit:{load:function(){var a=b.selection.getNode();"td"!=a.get("tag")&&(a=a.getParent("td"));this.el.getElement(".table-w").set("value",a.get("width"));this.el.getElement(".table-c").set("value",a.className);this.el.getElement(".table-a").set("value",a.get("align"));this.el.getElement(".table-va").set("value",a.get("valign"))},click:function(){var a=b.selection.getNode();"td"!=a.get("tag")&&(a=a.getParent("td"));a.set("width",this.el.getElement(".table-w").value);
a.className=this.el.getElement(".table-c").value;a.set("align",this.el.getElement(".table-a").value);a.set("valign",this.el.getElement(".table-va").value)}}};return new MooEditable.UI.Dialog(e[d],{"class":"mooeditable-table-dialog",onOpen:function(){f[d].load&&f[d].load.apply(this);var a=this.el.getElement("input");(function(){a.focus()}).delay(10)},onClick:function(a){"button"==a.target.tagName.toLowerCase()&&a.preventDefault();a=document.id(a.target);a.hasClass("dialog-cancel-button")?this.close():
a.hasClass("dialog-ok-button")&&(this.close(),f[d].click.apply(this))}})};
Object.append(MooEditable.Actions,{tableadd:{title:MooEditable.Locale.get("addTable"),dialogs:{prompt:function(b){return MooEditable.UI.TableDialog(b,"tableadd")}},command:function(){this.dialogs.tableadd.prompt.open()}},tableedit:{title:MooEditable.Locale.get("editTable"),dialogs:{prompt:function(b){return MooEditable.UI.TableDialog(b,"tableedit")}},command:function(){this.selection.getNode().getParent("table")&&this.dialogs.tableedit.prompt.open()}},tablerowadd:{title:"Add Row",command:function(){var b=
this.selection.getNode().getParent("tr");b&&b.clone().inject(b,"after")}},tablerowedit:{title:MooEditable.Locale.get("editTableRow"),dialogs:{prompt:function(b){return MooEditable.UI.TableDialog(b,"tablerowedit")}},command:function(){this.selection.getNode().getParent("table")&&this.dialogs.tablerowedit.prompt.open()}},tablerowspan:{title:MooEditable.Locale.get("mergeTableRow"),command:function(){var b=this.selection.getNode();"td"!=b.get("tag")&&(b=b.getParent("td"));if(b){var d=b.cellIndex,e=b.getParent().rowIndex;
b.getParent().getParent().childNodes[e+b.rowSpan]&&(b.getParent().getParent().childNodes[e+b.rowSpan].deleteCell(d),b.rowSpan++)}}},tablerowsplit:{title:MooEditable.Locale.get("splitTableRow"),command:function(){var b=this.selection.getNode();"td"!=b.get("tag")&&(b=b.getParent("td"));if(b){var d=b.cellIndex,e=b.getParent().rowIndex;if(b.getProperty("rowspan")){var f=parseInt(b.getProperty("rowspan"));for(i=1;i<f;i++)b.getParent().getParent().childNodes[e+i].insertCell(d);b.removeProperty("rowspan")}}},
states:function(b){"td"==b.get("tag")&&b&&b.getProperty("rowspan")&&1<parseInt(b.getProperty("rowspan"))&&this.el.addClass("onActive")}},tablerowdelete:{title:MooEditable.Locale.get("deleteTableRow"),command:function(){var b=this.selection.getNode().getParent("tr");b&&b.getParent().deleteRow(b.rowIndex)}},tablecoladd:{title:MooEditable.Locale.get("addTableCol"),command:function(){var b=this.selection.getNode();"td"!=b.get("tag")&&(b=b.getParent("td"));if(b)for(var d=b.cellIndex,e=b.getParent().getParent().childNodes.length,
f=0;f<e;f++){var a=$(b.getParent().getParent().childNodes[f].childNodes[d]);a.clone().inject(a,"after")}}},tablecoledit:{title:MooEditable.Locale.get("editTableCol"),dialogs:{prompt:function(b){return MooEditable.UI.TableDialog(b,"tablecoledit")}},command:function(){this.selection.getNode().getParent("table")&&this.dialogs.tablecoledit.prompt.open()}},tablecolspan:{title:MooEditable.Locale.get("mergeTableCell"),command:function(){var b=this.selection.getNode();"td"!=b.get("tag")&&(b=b.getParent("td"));
if(b){var d=b.cellIndex+1;b.getParent().childNodes[d]&&(b.getParent().deleteCell(d),b.colSpan++)}}},tablecolsplit:{title:MooEditable.Locale.get("splitTableCell"),command:function(){var b=this.selection.getNode();"td"!=b.get("tag")&&(b=b.getParent("td"));if(b){var d=b.cellIndex+1;if(b.getProperty("colspan")){var e=parseInt(b.getProperty("colspan"));for(i=1;i<e;i++)b.getParent().insertCell(d+i);b.removeProperty("colspan")}}},states:function(b){"td"==b.get("tag")&&b&&b.getProperty("colspan")&&1<parseInt(b.getProperty("colspan"))&&
this.el.addClass("onActive")}},tablecoldelete:{title:MooEditable.Locale.get("deleteTableCol"),command:function(){var b=this.selection.getNode();"td"!=b.get("tag")&&(b=b.getParent("td"));if(b)for(var d=b.getParent().getParent().childNodes.length,e=b.cellIndex,b=b.getParent().getParent(),f=0;f<d;f++)b.childNodes[f].deleteCell(e)}}});MooEditable.Locale.define({imageAlt:"alt",imageClass:"class",imageAlign:"align",imageAlignNone:"none",imageAlignLeft:"left",imageAlignCenter:"center",imageAlignRight:"right",addEditImage:"Add/Edit Image"});
MooEditable.UI.ImageDialog=function(b){var d=MooEditable.Locale.get("enterImageURL")+' <input type="text" class="dialog-url" value="" size="15"> '+MooEditable.Locale.get("imageAlt")+' <input type="text" class="dialog-alt" value="" size="8"> '+MooEditable.Locale.get("imageClass")+' <input type="text" class="dialog-class" value="" size="8"> '+MooEditable.Locale.get("imageAlign")+' <select class="dialog-align"><option>'+MooEditable.Locale.get("imageAlignNone")+"</option><option>"+MooEditable.Locale.get("imageAlignLeft")+
"</option><option>"+MooEditable.Locale.get("imageAlignCenter")+"</option><option>"+MooEditable.Locale.get("imageAlignRight")+'</option></select> <button class="dialog-button dialog-ok-button">'+MooEditable.Locale.get("ok")+'</button> <button class="dialog-button dialog-cancel-button">'+MooEditable.Locale.get("cancel")+"</button>";return new MooEditable.UI.Dialog(d,{"class":"mooeditable-image-dialog",onOpen:function(){var d=this.el.getElement(".dialog-url"),f=b.selection.getNode();"img"==f.get("tag")&&
(this.el.getElement(".dialog-url").set("value",f.get("src")),this.el.getElement(".dialog-alt").set("value",f.get("alt")),this.el.getElement(".dialog-class").set("value",f.className),this.el.getElement(".dialog-align").set("align",f.get("align")));(function(){d.focus();d.select()}).delay(10)},onClick:function(d){"button"==d.target.tagName.toLowerCase()&&d.preventDefault();d=document.id(d.target);if(d.hasClass("dialog-cancel-button"))this.close();else if(d.hasClass("dialog-ok-button")){this.close();
var d=this.el.getElement(".dialog-align"),f=b.selection.getNode();"img"==f.get("tag")?(f.set("src",this.el.getElement(".dialog-url").get("value").trim()),f.set("alt",this.el.getElement(".dialog-alt").get("value").trim()),f.className=this.el.getElement(".dialog-class").get("value").trim(),f.set("align",$(d.options[d.selectedIndex]).get("value"))):(f=new Element("div"),(new Element("img",{src:this.el.getElement(".dialog-url").get("value").trim(),alt:this.el.getElement(".dialog-alt").get("value").trim(),
"class":this.el.getElement(".dialog-class").get("value").trim(),align:$(d.options[d.selectedIndex]).get("value")})).inject(f),b.selection.insertContent(f.get("html")))}}})};MooEditable.Actions.image={title:MooEditable.Locale.get("addEditImage"),options:{shortcut:"m"},dialogs:{prompt:function(b){return MooEditable.UI.ImageDialog(b)}},command:function(){this.dialogs.image.prompt.open()}};MooEditable.Locale.define({embed:"Enter embed code",flashEmbed:"Flash Embed"});
MooEditable.UI.FlashDialog=function(b){var d=MooEditable.Locale.get("embed")+' <textarea class="dialog-f" value="" rows="2" cols="40"></textarea> <button class="dialog-button dialog-ok-button">'+MooEditable.Locale.get("ok")+'</button> <button class="dialog-button dialog-cancel-button">'+MooEditable.Locale.get("cancel")+"</button>";return new MooEditable.UI.Dialog(d,{"class":"mooeditable-flash-dialog",onOpen:function(){var b=this.el.getElement(".dialog-f");(function(){b.focus();b.select()}).delay(10)},
onClick:function(d){"button"==d.target.tagName.toLowerCase()&&d.preventDefault();d=document.id(d.target);d.hasClass("dialog-cancel-button")?this.close():d.hasClass("dialog-ok-button")&&(this.close(),d=(new Element("div")).set("html",this.el.getElement(".dialog-f").get("value").trim()),b.selection.insertContent(d.get("html")))}})};MooEditable.Actions.flash={title:MooEditable.Locale.get("flashEmbed"),dialogs:{prompt:function(b){return MooEditable.UI.FlashDialog(b)}},command:function(){this.dialogs.flash.prompt.open()}};MooEditable.Actions.Settings.charmap={chars:[["&nbsp;","&#160;"],["&amp;","&#38;"],["&quot;","&#34;"],["&cent;","&#162;"],["&euro;","&#8364;"],["&pound;","&#163;"],["&yen;","&#165;"],["&copy;","&#169;"],["&reg;","&#174;"],["&trade;","&#8482;"],["&permil;","&#8240;"],["&micro;","&#181;"],["&middot;","&#183;"],["&bull;","&#8226;"],["&hellip;","&#8230;"],["&prime;","&#8242;"],["&Prime;","&#8243;"],["&sect;","&#167;"],["&para;","&#182;"],["&szlig;","&#223;"],["&lsaquo;","&#8249;"],["&rsaquo;","&#8250;"],
["&laquo;","&#171;"],["&raquo;","&#187;"],["&lsquo;","&#8216;"],["&rsquo;","&#8217;"],["&ldquo;","&#8220;"],["&rdquo;","&#8221;"],["&sbquo;","&#8218;"],["&bdquo;","&#8222;"],["&lt;","&#60;"],["&gt;","&#62;"],["&le;","&#8804;"],["&ge;","&#8805;"],["&ndash;","&#8211;"],["&mdash;","&#8212;"],["&macr;","&#175;"],["&oline;","&#8254;"],["&curren;","&#164;"],["&brvbar;","&#166;"],["&uml;","&#168;"],["&iexcl;","&#161;"],["&iquest;","&#191;"],["&circ;","&#710;"],["&tilde;","&#732;"],["&deg;","&#176;"],["&minus;",
"&#8722;"],["&plusmn;","&#177;"],["&divide;","&#247;"],["&frasl;","&#8260;"],["&times;","&#215;"],["&sup1;","&#185;"],["&sup2;","&#178;"],["&sup3;","&#179;"],["&frac14;","&#188;"],["&frac12;","&#189;"],["&frac34;","&#190;"],["&fnof;","&#402;"],["&int;","&#8747;"],["&sum;","&#8721;"],["&infin;","&#8734;"],["&radic;","&#8730;"],["&sim;","&#8764;"],["&cong;","&#8773;"],["&asymp;","&#8776;"],["&ne;","&#8800;"],["&equiv;","&#8801;"],["&isin;","&#8712;"],["&notin;","&#8713;"],["&ni;","&#8715;"],["&prod;",
"&#8719;"],["&and;","&#8743;"],["&or;","&#8744;"],["&not;","&#172;"],["&cap;","&#8745;"],["&cup;","&#8746;"],["&part;","&#8706;"],["&forall;","&#8704;"],["&exist;","&#8707;"],["&empty;","&#8709;"],["&nabla;","&#8711;"],["&lowast;","&#8727;"],["&prop;","&#8733;"],["&ang;","&#8736;"],["&acute;","&#180;"],["&cedil;","&#184;"],["&ordf;","&#170;"],["&ordm;","&#186;"],["&dagger;","&#8224;"],["&Dagger;","&#8225;"],["&Agrave;","&#192;"],["&Aacute;","&#193;"],["&Acirc;","&#194;"],["&Atilde;","&#195;"],["&Auml;",
"&#196;"],["&Aring;","&#197;"],["&AElig;","&#198;"],["&Ccedil;","&#199;"],["&Egrave;","&#200;"],["&Eacute;","&#201;"],["&Ecirc;","&#202;"],["&Euml;","&#203;"],["&Igrave;","&#204;"],["&Iacute;","&#205;"],["&Icirc;","&#206;"],["&Iuml;","&#207;"],["&ETH;","&#208;"],["&Ntilde;","&#209;"],["&Ograve;","&#210;"],["&Oacute;","&#211;"],["&Ocirc;","&#212;"],["&Otilde;","&#213;"],["&Ouml;","&#214;"],["&Oslash;","&#216;"],["&OElig;","&#338;"],["&Scaron;","&#352;"],["&Ugrave;","&#217;"],["&Uacute;","&#218;"],
["&Ucirc;","&#219;"],["&Uuml;","&#220;"],["&Yacute;","&#221;"],["&Yuml;","&#376;"],["&THORN;","&#222;"],["&agrave;","&#224;"],["&aacute;","&#225;"],["&acirc;","&#226;"],["&atilde;","&#227;"],["&auml;","&#228;"],["&aring;","&#229;"],["&aelig;","&#230;"],["&ccedil;","&#231;"],["&egrave;","&#232;"],["&eacute;","&#233;"],["&ecirc;","&#234;"],["&euml;","&#235;"],["&igrave;","&#236;"],["&iacute;","&#237;"],["&icirc;","&#238;"],["&iuml;","&#239;"],["&eth;","&#240;"],["&ntilde;","&#241;"],["&ograve;","&#242;"],
["&oacute;","&#243;"],["&ocirc;","&#244;"],["&otilde;","&#245;"],["&ouml;","&#246;"],["&oslash;","&#248;"],["&oelig;","&#339;"],["&scaron;","&#353;"],["&ugrave;","&#249;"],["&uacute;","&#250;"],["&ucirc;","&#251;"],["&uuml;","&#252;"],["&yacute;","&#253;"],["&thorn;","&#254;"],["&yuml;","&#255;"],["&Alpha;","&#913;"],["&Beta;","&#914;"],["&Gamma;","&#915;"],["&Delta;","&#916;"],["&Epsilon;","&#917;"],["&Zeta;","&#918;"],["&Eta;","&#919;"],["&Theta;","&#920;"],["&Iota;","&#921;"],["&Kappa;","&#922;"],
["&Lambda;","&#923;"],["&Mu;","&#924;"],["&Nu;","&#925;"],["&Xi;","&#926;"],["&Omicron;","&#927;"],["&Pi;","&#928;"],["&Rho;","&#929;"],["&Sigma;","&#931;"],["&Tau;","&#932;"],["&Upsilon;","&#933;"],["&Phi;","&#934;"],["&Chi;","&#935;"],["&Psi;","&#936;"],["&Omega;","&#937;"],["&alpha;","&#945;"],["&beta;","&#946;"],["&gamma;","&#947;"],["&delta;","&#948;"],["&epsilon;","&#949;"],["&zeta;","&#950;"],["&eta;","&#951;"],["&theta;","&#952;"],["&iota;","&#953;"],["&kappa;","&#954;"],["&lambda;","&#955;"],
["&mu;","&#956;"],["&nu;","&#957;"],["&xi;","&#958;"],["&omicron;","&#959;"],["&pi;","&#960;"],["&rho;","&#961;"],["&sigmaf;","&#962;"],["&sigma;","&#963;"],["&tau;","&#964;"],["&upsilon;","&#965;"],["&phi;","&#966;"],["&chi;","&#967;"],["&psi;","&#968;"],["&omega;","&#969;"],["&alefsym;","&#8501;"],["&piv;","&#982;"],["&real;","&#8476;"],["&thetasym;","&#977;"],["&upsih;","&#978;"],["&weierp;","&#8472;"],["&image;","&#8465;"],["&larr;","&#8592;"],["&uarr;","&#8593;"],["&rarr;","&#8594;"],["&darr;",
"&#8595;"],["&harr;","&#8596;"],["&crarr;","&#8629;"],["&lArr;","&#8656;"],["&uArr;","&#8657;"],["&rArr;","&#8658;"],["&dArr;","&#8659;"],["&hArr;","&#8660;"],["&there4;","&#8756;"],["&sub;","&#8834;"],["&sup;","&#8835;"],["&nsub;","&#8836;"],["&sube;","&#8838;"],["&supe;","&#8839;"],["&oplus;","&#8853;"],["&otimes;","&#8855;"],["&perp;","&#8869;"],["&sdot;","&#8901;"],["&lceil;","&#8968;"],["&rceil;","&#8969;"],["&lfloor;","&#8970;"],["&rfloor;","&#8971;"],["&lang;","&#9001;"],["&rang;","&#9002;"],
["&loz;","&#9674;"],["&spades;","&#9824;"],["&clubs;","&#9827;"],["&hearts;","&#9829;"],["&diams;","&#9830;"]]};MooEditable.Locale.define({insertCustomCharacter:"Insert custom character",insertCharacter:"Insert character"});
MooEditable.UI.CharacterDialog=function(b){for(var d=MooEditable.Locale.get("insertCharacter")+' <select class="char">',e=MooEditable.Actions.Settings.charmap.chars,f=0,a=e.length;f<a;f++)d+='<option data-code="'+e[f][0]+'">'+e[f][1]+"</option>";d+='</select><button class="dialog-button dialog-ok-button">'+MooEditable.Locale.get("ok")+'</button><button class="dialog-button dialog-cancel-button">'+MooEditable.Locale.get("cancel")+"</button>";return new MooEditable.UI.Dialog(d,{"class":"mooeditable-charmap-dialog",
onClick:function(a){"button"==a.target.tagName.toLowerCase()&&a.preventDefault();a=document.id(a.target);a.hasClass("dialog-cancel-button")?this.close():a.hasClass("dialog-ok-button")&&(this.close(),a=a.getPrevious("select.char"),a=(new Element("div")).set("html",$(a.options[a.selectedIndex]).getProperty("data-code").trim()),b.selection.insertContent(a.get("html")))}})};
MooEditable.Actions.charmap={title:MooEditable.Locale.get("insertCustomCharacter"),dialogs:{prompt:function(b){return MooEditable.UI.CharacterDialog(b)}},command:function(){this.dialogs.charmap.prompt.open()},events:{toggleView:function(){if("textarea"==this.mode){var b=this.textarea.get("value");MooEditable.Actions.Settings.charmap.chars.each(function(d){if(!["&amp;","&gt;","&lt;","&quot;","&nbsp;"].contains(d[0])){var e=RegExp(String.fromCharCode(parseInt(d[1].replace("&#","").replace(";",""))),
"g");b=b.replace(e,d[0])}},this);this.textarea.set("value",b)}}}};MooEditable.Actions.Settings.pagebreak={imageFile:"../../Assets/MooEditable/Other/pagebreak.gif"};MooEditable.Locale.define("pageBreak","Page break");
MooEditable.Actions.pagebreak={title:MooEditable.Locale.get("pageBreak"),command:function(){this.selection.insertContent('<img class="mooeditable-visual-aid mooeditable-pagebreak">')},events:{attach:function(b){Browser.ie&&b.doc.addListener("controlselect",function(b){var e=b.target||b.srcElement;"img"==e.tagName.toLowerCase()&&document.id(e).hasClass("mooeditable-pagebreak")&&(b.preventDefault?b.preventDefault():b.returnValue=!1)})},editorMouseDown:function(b,d){var e=b.target,f="img"==e.tagName.toLowerCase()&&
$(e).hasClass("mooeditable-pagebreak");Function.attempt(function(){d.doc.execCommand("enableObjectResizing",!1,!f)})},beforeToggleView:function(){if("iframe"==this.mode){var b=this.getContent().replace(/<img([^>]*)class="mooeditable-visual-aid mooeditable-pagebreak"([^>]*)>/gi,"<\!-- page break --\>");this.setContent(b)}else b=this.textarea.get("value").replace(/<\!-- page break --\>/gi,'<img class="mooeditable-visual-aid mooeditable-pagebreak">'),this.textarea.set("value",b)},render:function(){this.options.extraCSS=
"img.mooeditable-pagebreak { display:block; width:100%; height:16px; background: url("+MooEditable.Actions.Settings.pagebreak.imageFile+") repeat-x; }"+this.options.extraCSS}}};